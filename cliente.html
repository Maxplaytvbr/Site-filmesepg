<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0f172a">
    <title>MaxPlay TV - Guia</title>
    <meta name="description" content="Guia MaxPlay TV com programa√ß√£o atualizada dos melhores canais, filmes e s√©ries.">
    <meta property="og:title" content="MaxPlay TV - Guia">
    <meta property="og:description" content="Veja a programa√ß√£o de hoje com filmes, s√©ries e canais ao vivo.">
    <meta property="og:image" content="https://i.postimg.cc/BvbCr0jH/IMG-6850.png">
    <link rel="icon" href="https://i.postimg.cc/BvbCr0jH/IMG-6850.png">
    
    <!-- Fontes -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dark-blue': '#0f172a',
                        'vibrant-orange': '#ff6b00',
                    },
                    fontFamily: {
                        'sans': ['Poppins', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <style>
        :root {
            --color-bg: #0f172a;
            --color-accent: #ff6b00;
            --color-text: #f8fafc;
            --transition-speed: 0.3s;
        }
        
        body {
            background-color: var(--color-bg);
            color: var(--color-text);
            font-family: 'Poppins', sans-serif;
        }
        
        /* Loader */
        .loading-spinner {
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-left-color: var(--color-accent);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Categorias */
        .category-title {
            position: relative;
            padding-left: 15px;
        }
        
        .category-title::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 5px;
            height: 80%;
            background-color: var(--color-accent);
            border-radius: 2px;
        }
        
        /* Cards de canal */
        .channel-card {
            background-color: rgba(255, 255, 255, 0.05);
            transition: all var(--transition-speed) ease;
            border: 1px solid rgba(255, 107, 0, 0.3);
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            min-height: 240px;
            overflow: hidden;
            backdrop-filter: blur(5px);
        }
        
        .channel-card:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .channel-card.favorite {
            border: 2px solid var(--color-accent);
            box-shadow: 0 0 10px rgba(255, 107, 0, 0.3);
        }
        
        .channel-name {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 150px;
        }
        
        .programme-item {
            border-left: 2px solid var(--color-accent);
            transition: all 0.2s ease;
            padding: 0.3rem 0.5rem;
        }
        
        .programme-item:hover {
            background-color: rgba(255, 107, 0, 0.1);
        }
        
        .programme-title, .programme-desc {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .programme-time {
            white-space: nowrap;
        }
        
        /* Filtros */
        .filter-btn {
            transition: all 0.2s ease;
        }
        
        .filter-btn.active {
            background-color: var(--color-accent);
            color: white;
        }
        
        .filter-btn:hover:not(.active) {
            background-color: rgba(255, 107, 0, 0.2);
        }
        
        /* Classifica√ß√£o indicativa */
        .rating-icon {
            width: 20px;
            height: 20px;
            display: inline-block;
            vertical-align: middle;
            margin-right: 5px;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 50;
            overflow-y: auto;
        }
        
        .modal-content {
            background-color: #1a2234;
            margin: 5% auto;
            width: 90%;
            max-width: 800px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            animation: modalFadeIn 0.3s;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-header {
            padding: 15px;
            border-bottom: 1px solid #2d3748;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-body {
            padding: 15px;
            max-height: 70vh;
            overflow-y: auto;
        }
        
        .modal-close {
            color: #a0aec0;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .modal-close:hover {
            color: var(--color-accent);
        }
        
        /* Favoritos */
        .favorite-star {
            transition: all 0.2s ease;
            cursor: pointer;
            font-size: 1.2rem;
            background: none;
            border: none;
            padding: 0;
        }
        
        .favorite-star:hover {
            transform: scale(1.2);
        }
        
        /* Responsividade */
        @media (max-width: 640px) {
            .filters-container {
                overflow-x: auto;
                white-space: nowrap;
                -webkit-overflow-scrolling: touch;
                padding-bottom: 10px;
            }
            
            .modal-content {
                width: 95%;
                margin: 10% auto;
            }
            
            .channel-card {
                min-height: 200px;
            }
        }
    </style>
</head>
<body>
    <!-- Bot√£o Voltar ao Topo -->
    <button id="back-to-top" class="fixed bottom-4 right-4 bg-vibrant-orange text-white p-3 rounded-full shadow-lg hidden z-50">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18" />
        </svg>
    </button>

    <header class="mb-6">
        <div class="flex flex-col md:flex-row justify-between items-center mb-6">
            <div class="flex items-center mb-4 md:mb-0">
                <img alt="MaxPlay TV Logo" class="h-12 mr-3" src="https://i.postimg.cc/BvbCr0jH/IMG-6850.png">
                <h1 class="text-2xl font-bold text-white">MaxPlay TV <span class="text-vibrant-orange">‚Äì Guia</span></h1>
            </div>
            
            <div class="flex flex-col sm:flex-row w-full md:w-auto gap-2">
                <div class="relative flex-grow">
                    <input class="w-full p-2 pl-3 pr-10 bg-gray-800 border border-gray-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-vibrant-orange" 
                           id="channel-search" 
                           placeholder="Buscar canal ou programa..." 
                           type="text">
                    <svg class="h-5 w-5 absolute right-3 top-2.5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
                    </svg>
                </div>
                
                <button class="px-4 py-2 bg-vibrant-orange text-white rounded-md hover:bg-opacity-90 transition-colors whitespace-nowrap" id="reload-epg">
                    <svg class="h-5 w-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
                    </svg>
                    Recarregar
                </button>
            </div>
        </div>
        
        <div class="flex justify-between items-center mb-4">
            <div class="current-time">
                <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
                </svg>
                <span id="current-time-display">Carregando...</span>
            </div>
            
            <div class="text-sm text-gray-400">
                √öltima atualiza√ß√£o: <span id="last-update">Carregando...</span>
            </div>
        </div>
    </header>
    
    <!-- Se√ß√£o de Filmes em Destaque -->
    <section class="px-4 py-6 text-white" id="filmes-destaque">
        <h2 class="text-2xl font-bold mb-4 text-orange-500">üé¨ FILMES PARA ASSISTIR HOJE</h2>
        <div class="flex gap-4 overflow-x-auto pb-4" id="filmes">
            <div class="loading-spinner mx-auto"></div>
        </div>
    </section>
    
    <!-- Se√ß√£o de Eventos Esportivos -->
    <section class="px-4 py-6 text-white" id="jogos-hoje">
        <h2 class="text-2xl font-bold mb-4 text-orange-500">üèüÔ∏è EVENTOS ESPORTIVOS MAXPLAY</h2>
        
        <div id="filtros-esportes" class="flex flex-wrap gap-2 mb-4">
            <button class="filter-esporte px-3 py-1 rounded bg-orange-600 text-white text-sm" data-esporte="Futebol">Futebol</button>
            <button class="filter-esporte px-3 py-1 rounded bg-gray-700 text-white text-sm" data-esporte="UFC">UFC</button>
            <button class="filter-esporte px-3 py-1 rounded bg-gray-700 text-white text-sm" data-esporte="Boxe">Boxe</button>
            <button class="filter-esporte px-3 py-1 rounded bg-gray-700 text-white text-sm" data-esporte="V√¥lei">V√¥lei</button>
            <button class="filter-esporte px-3 py-1 rounded bg-gray-700 text-white text-sm" data-esporte="Basquete">Basquete</button>
            <button class="filter-esporte px-3 py-1 rounded bg-gray-700 text-white text-sm" data-esporte="Outros Esportes">Outros</button>
        </div>
        
        <div class="flex overflow-x-auto gap-4 pb-4" id="jogos-container">
            <div class="loading-spinner mx-auto"></div>
        </div>
        
        <div class="flex justify-center mt-4 gap-2">
            <button id="ver-dia-anterior" class="px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600 transition hidden">
                <svg class="h-5 w-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                Dia Anterior
            </button>
            <button id="ver-hoje" class="px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600 transition hidden">
                <svg class="h-5 w-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                Ver Hoje
            </button>
            <button id="ver-proximo-dia" class="px-4 py-2 bg-vibrant-orange text-white rounded hover:bg-orange-600 transition">
                Pr√≥ximo Dia
                <svg class="h-5 w-5 inline-block ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </button>
        </div>
    </section>
    
    <!-- Se√ß√£o Principal de Canais -->
    <div class="container mx-auto px-4 py-6">
        <div class="flex justify-center items-center h-40" id="loading">
            <div class="loading-spinner"></div>
            <p class="ml-4 text-gray-300">Carregando programa√ß√£o...</p>
        </div>
        
        <div class="hidden bg-red-900 border border-red-700 text-white px-4 py-3 rounded mb-4" id="error-message"></div>
        
        <h2 class="text-2xl font-bold mb-4 text-orange-500">üì∫ CANAIS E PROGRAMA√á√ÉO DE HOJE</h2>
        
        <div class="filters-container overflow-x-auto pb-2">
            <div class="flex space-x-2 mb-4">
                <button class="filter-btn active px-3 py-1.5 rounded-md bg-gray-800 text-sm font-medium" data-filter="all">Todos</button>
                <button class="filter-btn px-3 py-1.5 rounded-md bg-gray-800 text-sm font-medium" data-filter="movies">Filmes e S√©ries</button>
                <button class="filter-btn px-3 py-1.5 rounded-md bg-gray-800 text-sm font-medium" data-filter="documentary">Document√°rios</button>
                <button class="filter-btn px-3 py-1.5 rounded-md bg-gray-800 text-sm font-medium" data-filter="kids">Infantis</button>
                <button class="filter-btn px-3 py-1.5 rounded-md bg-gray-800 text-sm font-medium" data-filter="sports">Esportes</button>
                <button class="filter-btn px-3 py-1.5 rounded-md bg-gray-800 text-sm font-medium" data-filter="adult">Adulto</button>
                <button class="filter-btn px-3 py-1.5 rounded-md bg-gray-800 text-sm font-medium" data-filter="open">Canais Abertos</button>
                <button class="filter-btn px-3 py-1.5 rounded-md bg-gray-800 text-sm font-medium" data-filter="news">Not√≠cias</button>
                <button class="filter-btn px-3 py-1.5 rounded-md bg-gray-800 text-sm font-medium" data-time="morning">Manh√£</button>
                <button class="filter-btn px-3 py-1.5 rounded-md bg-gray-800 text-sm font-medium" data-time="afternoon">Tarde</button>
                <button class="filter-btn px-3 py-1.5 rounded-md bg-gray-800 text-sm font-medium" data-time="evening">Noite</button>
            </div>
        </div>
        
        <div class="hidden" id="channels-container">
            <!-- Se√ß√£o de Favoritos -->
            <section class="mb-8" id="favorites-section">
                <h2 class="category-title text-xl font-bold mb-4 text-vibrant-orange">Favoritos</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4" id="favorites-channels"></div>
            </section>
            
            <!-- Se√ß√£o de Filmes e S√©ries -->
            <section class="mb-8" id="movies-section">
                <h2 class="category-title text-xl font-bold mb-4 text-vibrant-orange">Filmes e S√©ries</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4" id="movies-channels"></div>
            </section>
            
            <!-- Se√ß√£o de Document√°rios -->
            <section class="mb-8" id="documentary-section">
                <h2 class="category-title text-xl font-bold mb-4 text-vibrant-orange">Document√°rios</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4" id="documentary-channels"></div>
            </section>
            
            <!-- Se√ß√£o Infantil -->
            <section class="mb-8" id="kids-section">
                <h2 class="category-title text-xl font-bold mb-4 text-vibrant-orange">Infantis</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4" id="kids-channels"></div>
            </section>
            
            <!-- Se√ß√£o de Esportes -->
            <section class="mb-8" id="sports-section">
                <h2 class="category-title text-xl font-bold mb-4 text-vibrant-orange">Esportes</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4" id="sports-channels"></div>
            </section>
            
            <!-- Se√ß√£o de Outros Canais -->
            <section class="mb-8" id="other-section">
                <h2 class="category-title text-xl font-bold mb-4 text-vibrant-orange">Outros Canais</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4" id="other-channels"></div>
            </section>
        </div>
    </div>
    
    <!-- Modal de Programa√ß√£o Completa -->
    <div class="modal" id="schedule-modal">
        <div class="modal-content">
            <div class="modal-header bg-gray-800">
                <div class="flex items-center">
                    <img alt="Channel Logo" class="h-8 mr-2" id="modal-channel-logo" src="">
                    <h3 class="text-lg font-bold text-white" id="modal-channel-name">Canal</h3>
                </div>
                <span class="modal-close">√ó</span>
            </div>
            <div class="modal-body">
                <div class="space-y-3" id="modal-schedule-list"></div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Configura√ß√µes globais
        const tmdbApiKey = "54b9cff0f48a3f127fa5cd5906bbe251";
        const epgSources = [
            "https://raw.githubusercontent.com/limaalef/BrazilTVEPG/main/vivoplay.xml",
            "https://raw.githubusercontent.com/limaalef/BrazilTVEPG/main/claro.xml",
            "https://raw.githubusercontent.com/limaalef/BrazilTVEPG/main/epg.xml"
        ];
        
        // Canais esportivos permitidos
        const canaisEsportivos = [
            "SporTV", "SporTV 2", "SporTV 3", "ESPN", "ESPN 2", "ESPN 3", "ESPN 4",
            "Fox Sports", "Fox Sports 2", "Band Sports", "Premiere", "Combate", "OFF", "Woohoo"
        ];
        
        // Mapeamento de logos de canais
        const channelLogos = {
            'Warner': 'https://i.postimg.cc/SxBRcBBk/IMG-6821.png',
            'Sony': 'https://i.postimg.cc/bwDdDyFm/IMG-6878.jpg',
            'TNT': 'https://i.postimg.cc/kXhBg6wV/IMG-6879.png',
            'TNT Novelas': 'https://i.postimg.cc/1RB8bYqr/IMG-6880.jpg',
            'Space': 'https://i.postimg.cc/D0xms8TM/IMG-6881.jpg',
            'Cinemax': 'https://i.postimg.cc/x8fccLWm/IMG-6882.jpg',
            'Megapix': 'https://i.postimg.cc/fLjVz8gZ/IMG-6883.jpg',
            'Sony Movies': 'https://i.postimg.cc/mDGcWvj8/IMG-6884.jpg',
            'Fox': 'https://i.postimg.cc/0NS63kYz/IMG-6885.jpg',
            'Animal Planet': 'https://i.postimg.cc/pXdmvYQb/IMG-6886.png',
            'History': 'https://i.postimg.cc/FH7kyg1g/IMG-6887.jpg',
            'Discovery Kids': 'https://i.postimg.cc/bwWD3DtX/IMG-6888.png',
            'Band': 'https://i.postimg.cc/c41nHNSz/IMG-6889.png',
            'Band Sports': 'https://i.postimg.cc/Pr68vFf5/IMG-6890.png',
            'Globo': 'https://logodownload.org/wp-content/uploads/2013/12/rede-globo-logo-0.png',
            'SBT': 'https://logodownload.org/wp-content/uploads/2013/12/sbt-logo-0.png',
            'Record': 'https://logodownload.org/wp-content/uploads/2014/02/record-logo-tv-0.png',
            'HBO': 'https://logodownload.org/wp-content/uploads/2017/04/hbo-logo-1.png',
            'Telecine': 'https://logodownload.org/wp-content/uploads/2017/07/telecine-logo-1.png',
            'SporTV': 'https://logodownload.org/wp-content/uploads/2017/07/sportv-logo-0.png',
            'ESPN': 'https://logodownload.org/wp-content/uploads/2015/05/espn-logo-4.png',
            'Discovery': 'https://logodownload.org/wp-content/uploads/2017/04/discovery-channel-logo-1.png',
            'Cartoon Network': 'https://logodownload.org/wp-content/uploads/2018/06/cartoon-network-logo-1.png',
            'Nickelodeon': 'https://logodownload.org/wp-content/uploads/2018/07/nickelodeon-logo-1.png',
            'Disney': 'https://logodownload.org/wp-content/uploads/2018/10/disney-channel-logo-1.png',
            'GloboNews': 'https://logodownload.org/wp-content/uploads/2017/07/globo-news-logo-0.png',
            'CNN Brasil': 'https://logodownload.org/wp-content/uploads/2020/02/cnn-brasil-logo-0.png',
            "AMC": "https://i.postimg.cc/t4vK31X0/IMG-6911.jpg",
            "AXN": "https://i.postimg.cc/qM4H4VmF/IMG-6909.jpg",
            "A&E": "https://i.postimg.cc/15BhzC23/IMG-6912.png",
            "Prime Box Brazil": "https://i.postimg.cc/2yYMkhxW/IMG-6913.png",
            "Comedy Central": "https://i.postimg.cc/k5kLHk6f/IMG-6914.png",
            "Paramount Network": "https://i.postimg.cc/KzBChJtF/IMG-6915.png",
            "Travel Box": "https://i.postimg.cc/xjGBsp03/IMG-6916.png",
            "TLC": "https://i.postimg.cc/Prt90bJs/IMG-6917.png",
            "E!": "https://i.postimg.cc/SND34XYX/IMG-6918.jpg",
            "Arte 1": "https://i.postimg.cc/VkvTkYXK/IMG-6919.png",
            "Fish": "https://i.postimg.cc/T3ssyZ9f/IMG-6920.png",
            "Nick Jr.": "https://i.postimg.cc/Xqn1S3Vc/IMG-6924.png",
            "Nickelodeon": "https://i.postimg.cc/yNSb0vQ9/IMG-6921.png",
            "Cartoon Network": "https://i.postimg.cc/ZRtDHp2Q/IMG-6922.png",
            "Cartoonito": "https://i.postimg.cc/hjLZ5hqt/IMG-6923.png",
            "Premiere": "https://i.postimg.cc/dQ9SR7BW/IMG-6926.png",
            "Record": "https://i.postimg.cc/Vv4GzTvy/IMG-6925.png",
            "RedeTV!": "https://i.postimg.cc/xTTp60p9/IMG-6927.png"
        };
        
        // Logos dos canais esportivos
        const logosCanaisEsportivos = {
            "SporTV": "https://logodownload.org/wp-content/uploads/2017/07/sportv-logo.png",
            "ESPN": "https://logodownload.org/wp-content/uploads/2015/05/espn-logo.png",
            "Premiere": "https://logodownload.org/wp-content/uploads/2020/04/premiere-fc-logo.png",
            "Fox Sports": "https://logodownload.org/wp-content/uploads/2018/09/fox-sports-logo.png",
            "Band Sports": "https://logodownload.org/wp-content/uploads/2017/07/band-sports-logo.png",
            "Combate": "https://logodownload.org/wp-content/uploads/2017/07/combate-logo.png"
        };
        
        // Escudos de times esportivos
        const escudos = {
            // Times brasileiros
            "Corinthians": "https://logodownload.org/wp-content/uploads/2019/12/corinthians-logo.png",
            "Palmeiras": "https://logodownload.org/wp-content/uploads/2019/12/palmeiras-logo.png",
            "S√£o Paulo": "https://logodownload.org/wp-content/uploads/2019/12/sao-paulo-logo.png",
            "Santos": "https://logodownload.org/wp-content/uploads/2019/12/santos-logo.png",
            "Flamengo": "https://logodownload.org/wp-content/uploads/2019/12/flamengo-logo.png",
            "Fluminense": "https://logodownload.org/wp-content/uploads/2019/12/fluminense-logo.png",
            "Vasco": "https://logodownload.org/wp-content/uploads/2019/12/vasco-logo.png",
            "Botafogo": "https://logodownload.org/wp-content/uploads/2019/12/botafogo-logo.png",
            "Gr√™mio": "https://logodownload.org/wp-content/uploads/2019/12/gremio-logo.png",
            "Internacional": "https://logodownload.org/wp-content/uploads/2019/12/internacional-logo.png",
            "Atl√©tico-MG": "https://logodownload.org/wp-content/uploads/2019/12/atletico-mineiro-logo.png",
            "Cruzeiro": "https://logodownload.org/wp-content/uploads/2019/12/cruzeiro-logo.png",
            "Bahia": "https://logodownload.org/wp-content/uploads/2019/12/bahia-logo.png",
            "Vit√≥ria": "https://logodownload.org/wp-content/uploads/2019/12/vitoria-logo.png",
            "Sport": "https://logodownload.org/wp-content/uploads/2019/12/sport-logo.png",
            "N√°utico": "https://logodownload.org/wp-content/uploads/2019/12/nautico-logo.png",
            "Cear√°": "https://logodownload.org/wp-content/uploads/2019/12/ceara-logo.png",
            "Fortaleza": "https://logodownload.org/wp-content/uploads/2019/12/fortaleza-logo.png",
            "Figueirense": "https://logodownload.org/wp-content/uploads/2019/12/figueirense-logo.png",
            
            // Times internacionais
            "Brasil": "https://upload.wikimedia.org/wikipedia/commons/thumb/0/05/Flag_of_Brazil.svg/1200px-Flag_of_Brazil.svg.png",
            "Argentina": "https://upload.wikimedia.org/wikipedia/commons/thumb/1/1a/Flag_of_Argentina.svg/1200px-Flag_of_Argentina.svg.png",
            "Fran√ßa": "https://upload.wikimedia.org/wikipedia/commons/thumb/b/ba/Flag_of_France.svg/1200px-Flag_of_France.svg.png",
            "Alemanha": "https://upload.wikimedia.org/wikipedia/commons/thumb/b/ba/Flag_of_Germany.svg/1200px-Flag_of_Germany.svg.png",
            "PSG": "https://upload.wikimedia.org/wikipedia/en/thumb/a/a7/Paris_Saint-Germain_F.C..svg/1200px-Paris_Saint-Germain_F.C..svg.png",
            "Real Madrid": "https://upload.wikimedia.org/wikipedia/en/thumb/5/56/Real_Madrid_CF.svg/1200px-Real_Madrid_CF.svg.png",
            "Barcelona": "https://upload.wikimedia.org/wikipedia/en/thumb/4/47/FC_Barcelona_%28crest%29.svg/1200px-FC_Barcelona_%28crest%29.svg.png",
            "Manchester United": "https://upload.wikimedia.org/wikipedia/en/thumb/7/7a/Manchester_United_FC_crest.svg/1200px-Manchester_United_FC_crest.svg.png",
            "Liverpool": "https://upload.wikimedia.org/wikipedia/en/thumb/0/0c/Liverpool_FC.svg/1200px-Liverpool_FC.svg.png",
            "Bayern Munich": "https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/FC_Bayern_M%C3%BCnchen_logo_%282017%29.svg/1200px-FC_Bayern_M%C3%BCnchen_logo_%282017%29.svg.png",
            
            // V√¥lei
            "Sada Cruzeiro": "https://upload.wikimedia.org/wikipedia/pt/thumb/5/5e/Sada_Cruzeiro_Volei.png/1200px-Sada_Cruzeiro_Volei.png",
            "Minas": "https://upload.wikimedia.org/wikipedia/pt/thumb/2/2e/Minas_T%C3%AAnis_Clube.png/1200px-Minas_T%C3%AAnis_Clube.png",
            "TAU": "https://upload.wikimedia.org/wikipedia/pt/thumb/1/1e/Taubat%C3%A9_VC.png/1200px-Taubat%C3%A9_VC.png",
            
            // Basquete
            "Flamengo Basquete": "https://upload.wikimedia.org/wikipedia/pt/thumb/f/f7/Flamengo_logo.svg/1200px-Flamengo_logo.svg.png",
            "S√£o Paulo Basquete": "https://upload.wikimedia.org/wikipedia/pt/thumb/2/2e/Sao_Paulo_FC_logo.svg/1200px-Sao_Paulo_FC_logo.svg.png",
            
            // NBA
            "Lakers": "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3c/Los_Angeles_Lakers_logo.svg/1200px-Los_Angeles_Lakers_logo.svg.png",
            "Warriors": "https://upload.wikimedia.org/wikipedia/en/thumb/0/01/Golden_State_Warriors_logo.svg/1200px-Golden_State_Warriors_logo.svg.png",
            "Bulls": "https://upload.wikimedia.org/wikipedia/en/thumb/6/67/Chicago_Bulls_logo.svg/1200px-Chicago_Bulls_logo.svg.png",
            
            // UFC (para eventos de MMA)
            "UFC": "https://upload.wikimedia.org/wikipedia/commons/thumb/9/92/UFC_Logo.svg/1200px-UFC_Logo.svg.png"
        };

        // Imagens de lutadores do UFC
        const lutadoresUFC = {
            "Gilbert Burns": "https://dmxg5wxfqgb4u.cloudfront.net/styles/athlete_bio_full_body/s3/2023-03/BURNS_GILBERT_L_BELTON_03_04.png",
            "Rodolfo Bellato": "https://dmxg5wxfqgb4u.cloudfront.net/styles/athlete_bio_full_body/s3/2023-11/BELLATO_RODOLFO_L_11-04.png",
            "Mairon Santos": "https://dmxg5wxfqgb4u.cloudfront.net/styles/athlete_bio_full_body/s3/2024-01/SANTOS_MAIRON_L_01-20.png",
            "Luana Santos": "https://dmxg5wxfqgb4u.cloudfront.net/styles/athlete_bio_full_body/s3/2023-06/SANTOS_LUANA_L_06-03.png",
            "Luana Pinheiro": "https://dmxg5wxfqgb4u.cloudfront.net/styles/athlete_bio_full_body/s3/2023-05/PINHEIRO_LUANA_L_05-06.png",
            "Sean O'Malley": "https://dmxg5wxfqgb4u.cloudfront.net/styles/athlete_bio_full_body/s3/2023-08/OMALLEY_SEAN_L_08-19.png",
            "Israel Adesanya": "https://dmxg5wxfqgb4u.cloudfront.net/styles/athlete_bio_full_body/s3/2023-09/ADESANYA_ISRAEL_L_09-09.png",
            "Jon Jones": "https://dmxg5wxfqgb4u.cloudfront.net/styles/athlete_bio_full_body/s3/2023-03/JONES_JON_L_03-04.png",
            "Anderson Silva": "https://dmxg5wxfqgb4u.cloudfront.net/styles/athlete_bio_full_body/s3/2020-07/SILVA_ANDERSON_L_07-11.png",
            "Vitor Belfort": "https://dmxg5wxfqgb4u.cloudfront.net/styles/athlete_bio_full_body/s3/2018-05/BELFORT_VITOR_L_05-12.png",
            "Jos√© Aldo": "https://dmxg5wxfqgb4u.cloudfront.net/styles/athlete_bio_full_body/s3/2022-08/ALDO_JOSE_L_08-20.png"
        };

        // Classifica√ß√£o indicativa
        const ratingImages = {
            'L': 'https://i.postimg.cc/7PnzwZp7/IMG-6891.png',
            '10': 'https://i.postimg.cc/FzpkZTjG/IMG-6892.png',
            '12': 'https://i.postimg.cc/LXz1q95c/IMG-6893.png',
            '14': 'https://i.postimg.cc/sxsZ7kZv/IMG-6894.png',
            '16': 'https://i.postimg.cc/wvKNTyq5/IMG-6895.png',
            '18': 'https://i.postimg.cc/LsgfpBp6/IMG-6896.png'
        };
        
        // Dias da semana abreviados
        const weekdaysShort = {
            0: 'dom', 1: 'seg', 2: 'ter', 3: 'qua', 4: 'qui', 5: 'sex', 6: 'sab'
        };
        
        // Categorias de canais
        const channelCategories = {
            'movies': ['HBO', 'HBO2', 'HBO Plus', 'HBO Family', 'HBO Signature', 'HBO Mundi', 'HBO Pop', 'HBO Xtreme', 
                      'Telecine Premium', 'Telecine Action', 'Telecine Touch', 'Telecine Fun', 'Telecine Pipoca', 'Telecine Cult',
                      'Megapix', 'Universal TV', 'Studio Universal', 'Warner', 'AXN', 'Sony', 'FX', 'Paramount Network',
                      'Cinemax', 'Prime Box Brazil', 'TNT', 'TNT Series', 'TNT Novelas', 'Space', 'AMC', 'Film&Arts', 'Syfy', 'Comedy Central',
                      'TBS', 'A&E', 'Star Channel', 'Lifetime', 'Canal Brasil', 'TCM', 'Cine Brasil TV', 'CineBrasilTV', 'Sony Movies', 'Fox'],
            
            'documentary': ['Discovery Channel', 'Animal Planet', 'Nat Geo', 'National Geographic', 'History', 'History 2', 'Discovery Science', 
                           'Discovery Theater', 'Discovery World', 'Discovery Turbo', 'Discovery Home & Health', 'Discovery ID', 'TLC', 
                           'E!', 'Curta!', 'Arte 1', 'Fashion TV', 'Travel Box Brazil', 'Fish TV', 'Smithsonian Channel'],
            
            'kids': ['Cartoon Network', 'Nickelodeon', 'Nick Jr.', 'Disney Channel', 'Disney Junior', 'Discovery Kids', 'Gloob', 
                    'Gloobinho', 'Tooncast', 'Cartoonito', 'ZooMoo', 'TV R√°-Tim-Bum', 'Nat Geo Kids'],
            
            'sports': ['SporTV', 'SporTV 2', 'SporTV 3', 'ESPN', 'ESPN 2', 'ESPN 3', 'ESPN 4', 'Fox Sports', 'Fox Sports 2', 
                      'Band Sports', 'Premiere', 'Premiere 2', 'Premiere 3', 'Premiere 4', 'Premiere 5', 'Premiere 6', 
                      'Premiere 7', 'Premiere 8', 'Combate', 'OFF', 'Woohoo'],
            
            'news': ['GloboNews', 'CNN Brasil', 'Record News', 'BandNews', 'Jovem Pan News', 'Bloomberg'],
            
            'open': ['Globo', 'SBT', 'Record', 'Band', 'RedeTV!', 'TV Cultura', 'TV Brasil', 'TV Gazeta', 'Futura', 'TV C√¢mara', 'TV Senado', 'TV Justi√ßa'],
            
            'adult': ['Playboy TV', 'Sexy Hot', 'Venus', 'Sextreme', 'Hustler TV', 'Penthouse TV']
        };

        // Inicializa√ß√£o quando o DOM estiver pronto
        document.addEventListener('DOMContentLoaded', () => {
            // Elementos da interface
            const loadingElement = document.getElementById('loading');
            const errorElement = document.getElementById('error-message');
            const channelsContainer = document.getElementById('channels-container');
            const channelSearch = document.getElementById('channel-search');
            const reloadButton = document.getElementById('reload-epg');
            const modal = document.getElementById('schedule-modal');
            const modalClose = document.querySelector('.modal-close');
            const modalChannelName = document.getElementById('modal-channel-name');
            const modalChannelLogo = document.getElementById('modal-channel-logo');
            const modalScheduleList = document.getElementById('modal-schedule-list');
            const currentTimeDisplay = document.getElementById('current-time-display');
            const lastUpdateDisplay = document.getElementById('last-update');
            const verProximoDiaBtn = document.getElementById('ver-proximo-dia');
            const verHojeBtn = document.getElementById('ver-hoje');
            const verDiaAnteriorBtn = document.getElementById('ver-dia-anterior');
            const backToTopButton = document.getElementById('back-to-top');
            const favoritesChannelsContainer = document.getElementById('favorites-channels');
            
            // Containers de canais por categoria
            const moviesChannels = document.getElementById('movies-channels');
            const documentaryChannels = document.getElementById('documentary-channels');
            const kidsChannels = document.getElementById('kids-channels');
            const sportsChannels = document.getElementById('sports-channels');
            const otherChannels = document.getElementById('other-channels');
            
            // Filtros
            const filterButtons = document.querySelectorAll('.filter-btn');
            const filterEsporteButtons = document.querySelectorAll('.filter-esporte');
            
            // Vari√°veis de estado
            let allProgrammesByChannel = {};
            let autoUpdateTimer = null;
            const AUTO_UPDATE_INTERVAL = 60000; // 1 minuto
            let currentSportFilter = 'Futebol';
            let currentDayOffset = 0;
            let allChannelsData = new Map();
            
            // Inicializa√ß√£o
            updateCurrentTime();
            setInterval(updateCurrentTime, 1000);
            
            // Configurar bot√£o voltar ao topo
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopButton.classList.remove('hidden');
                } else {
                    backToTopButton.classList.add('hidden');
                }
            });
            
            backToTopButton.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
            
            fetchEPGData();
            carregarFilmes();
            carregarEventosEsportivos();
            
            // Event Listeners
            channelSearch.addEventListener('input', handleSearch);
            reloadButton.addEventListener('click', handleReload);
            modalClose.addEventListener('click', () => modal.style.display = 'none');
            window.addEventListener('click', (event) => {
                if (event.target === modal) modal.style.display = 'none';
            });
            
            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    if (this.dataset.time) {
                        handleTimeFilterClick.call(this);
                    } else {
                        handleFilterClick.call(this);
                    }
                });
            });
            
            filterEsporteButtons.forEach(button => {
                button.addEventListener('click', handleSportFilterClick);
            });
            
            verProximoDiaBtn.addEventListener('click', () => {
                currentDayOffset++;
                updateDayNavigationButtons();
                carregarEventosEsportivos();
            });
            
            verHojeBtn.addEventListener('click', () => {
                currentDayOffset = 0;
                updateDayNavigationButtons();
                carregarEventosEsportivos();
            });
            
            verDiaAnteriorBtn.addEventListener('click', () => {
                currentDayOffset--;
                updateDayNavigationButtons();
                carregarEventosEsportivos();
            });
            
            // Fun√ß√µes principais
            function updateCurrentTime() {
                const now = new Date();
                currentTimeDisplay.textContent = now.toLocaleTimeString('pt-BR', {
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
            }
            
            function updateDayNavigationButtons() {
                if (currentDayOffset > 0) {
                    verDiaAnteriorBtn.classList.remove('hidden');
                    verHojeBtn.classList.remove('hidden');
                } else if (currentDayOffset < 0) {
                    verDiaAnteriorBtn.classList.remove('hidden');
                    verHojeBtn.classList.remove('hidden');
                } else {
                    verDiaAnteriorBtn.classList.add('hidden');
                    verHojeBtn.classList.add('hidden');
                }
            }
            
            function handleSearch(e) {
                const searchTerm = e.target.value.toLowerCase();
                const channelCards = document.querySelectorAll('#channels-container .channel-card');
                
                channelCards.forEach(card => {
                    const channelName = card.querySelector('.channel-name').textContent.toLowerCase();
                    const programmes = Array.from(card.querySelectorAll('.programme-title')).map(el => el.textContent.toLowerCase());
                    
                    if (channelName.includes(searchTerm) || programmes.some(prog => prog.includes(searchTerm))) {
                        card.classList.remove('hidden');
                    } else {
                        card.classList.add('hidden');
                    }
                });
                
                checkEmptySections();
            }
            
            function handleReload() {
                loadingElement.classList.remove('hidden');
                channelsContainer.classList.add('hidden');
                errorElement.classList.add('hidden');
                
                moviesChannels.innerHTML = '';
                documentaryChannels.innerHTML = '';
                kidsChannels.innerHTML = '';
                sportsChannels.innerHTML = '';
                otherChannels.innerHTML = '';
                favoritesChannelsContainer.innerHTML = '';
                
                if (autoUpdateTimer) clearInterval(autoUpdateTimer);
                
                fetchEPGData();
                carregarFilmes();
                carregarEventosEsportivos();
            }
            
            function handleFilterClick() {
                filterButtons.forEach(btn => {
                    if (!btn.dataset.time) {
                        btn.classList.remove('active');
                    }
                });
                this.classList.add('active');
                
                const filter = this.dataset.filter;
                const sections = document.querySelectorAll('#channels-container section');
                const channelCards = document.querySelectorAll('#channels-container .channel-card');
                
                if (filter === 'all') {
                    sections.forEach(section => section.classList.remove('hidden'));
                    channelCards.forEach(card => card.classList.remove('hidden'));
                } else {
                    sections.forEach(section => {
                        if (section.id === 'favorites-section') {
                            section.classList.remove('hidden');
                        } else if (section.id === `${filter}-section`) {
                            section.classList.remove('hidden');
                        } else {
                            section.classList.add('hidden');
                        }
                    });
                    
                    channelCards.forEach(card => {
                        if (card.dataset.category === filter) {
                            card.classList.remove('hidden');
                        } else {
                            card.classList.add('hidden');
                        }
                    });
                }
                
                checkEmptySections();
            }
            
            function handleTimeFilterClick() {
                const timeRange = this.dataset.time;
                const now = new Date();
                const currentHour = now.getHours();
                
                document.querySelectorAll('#channels-container .programme-item').forEach(item => {
                    const timeText = item.querySelector('.programme-time').textContent;
                    const hourMatch = timeText.match(/(\d{1,2}):\d{2}/);
                    if (!hourMatch) return;
                    
                    const hour = parseInt(hourMatch[1]);
                    let showItem = false;
                    
                    switch(timeRange) {
                        case 'morning':
                            showItem = hour >= 6 && hour < 12;
                            break;
                        case 'afternoon':
                            showItem = hour >= 12 && hour < 18;
                            break;
                        case 'evening':
                            showItem = hour >= 18 || hour < 6;
                            break;
                        default:
                            showItem = true;
                    }
                    
                    item.style.display = showItem ? 'block' : 'none';
                });
            }
            
            function handleSportFilterClick() {
                filterEsporteButtons.forEach(btn => btn.classList.remove('bg-orange-600'));
                this.classList.add('bg-orange-600');
                currentSportFilter = this.dataset.esporte;
                currentDayOffset = 0;
                updateDayNavigationButtons();
                carregarEventosEsportivos();
            }
            
            async function fetchEPGData() {
                allChannelsData = new Map();
                
                try {
                    for (const url of epgSources) {
                        try {
                            const response = await fetch(url);
                            const xmlText = await response.text();
                            const xmlDoc = new DOMParser().parseFromString(xmlText, 'text/xml');
                            
                            // Processa canais
                            const channels = xmlDoc.getElementsByTagName('channel');
                            for (let i = 0; i < channels.length; i++) {
                                const channel = channels[i];
                                const channelId = channel.getAttribute('id');
                                const displayName = channel.getElementsByTagName('display-name')[0]?.textContent.trim();
                                
                                if (!allChannelsData.has(channelId)) {
                                    allChannelsData.set(channelId, {
                                        id: channelId,
                                        name: displayName,
                                        source: url,
                                        xmlNode: channel
                                    });
                                }
                            }
                            
                            // Processa programas
                            const programmes = xmlDoc.getElementsByTagName('programme');
                            for (let i = 0; i < programmes.length; i++) {
                                const programme = programmes[i];
                                const channelId = programme.getAttribute('channel');
                                
                                if (allChannelsData.has(channelId)) {
                                    if (!allChannelsData.get(channelId).programmes) {
                                        allChannelsData.get(channelId).programmes = [];
                                    }
                                    allChannelsData.get(channelId).programmes.push(programme);
                                }
                            }
                        } catch (error) {
                            console.error(`Erro ao processar EPG de ${url}:`, error);
                        }
                    }
                    
                    processEPGData();
                    
                    const now = new Date();
                    lastUpdateDisplay.textContent = now.toLocaleTimeString('pt-BR', {
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                    
                    if (autoUpdateTimer) clearInterval(autoUpdateTimer);
                    autoUpdateTimer = setInterval(updateProgrammesDisplay, AUTO_UPDATE_INTERVAL);
                } catch (error) {
                    console.error('Erro ao carregar o EPG:', error);
                    loadingElement.classList.add('hidden');
                    errorElement.textContent = `Erro ao carregar a programa√ß√£o: ${error.message}`;
                    errorElement.classList.remove('hidden');
                }
            }
            
            function processEPGData() {
                try {
                    allProgrammesByChannel = {};
                    const uniqueChannels = Array.from(allChannelsData.values());
                    
                    // Agrupa programas por canal
                    uniqueChannels.forEach(channelData => {
                        allProgrammesByChannel[channelData.id] = channelData.programmes || [];
                        createAndAppendChannelCard(channelData.name, channelData.id);
                    });
                    
                    displayChannels();
                    checkEmptySections();
                    loadingElement.classList.add('hidden');
                    channelsContainer.classList.remove('hidden');
                    
                } catch (error) {
                    console.error('Erro ao processar o EPG:', error);
                    loadingElement.classList.add('hidden');
                    errorElement.textContent = `Erro ao processar a programa√ß√£o: ${error.message}`;
                    errorElement.classList.remove('hidden');
                }
            }
            
            function displayChannels() {
                const favorites = JSON.parse(localStorage.getItem('favoriteChannels')) || {};
                
                // Limpa os containers
                moviesChannels.innerHTML = '';
                documentaryChannels.innerHTML = '';
                kidsChannels.innerHTML = '';
                sportsChannels.innerHTML = '';
                otherChannels.innerHTML = '';
                favoritesChannelsContainer.innerHTML = '';
                
                // Ordena canais (favoritos primeiro)
                const allChannels = Array.from(allChannelsData.values());
                allChannels.sort((a, b) => {
                    const aFav = favorites[a.id];
                    const bFav = favorites[b.id];
                    return (aFav === bFav) ? 0 : aFav ? -1 : 1;
                });
                
                // Adiciona os canais
                allChannels.forEach(channelData => {
                    const channelCard = createChannelCard(channelData.name, channelData.id);
                    
                    // Adiciona aos favoritos se necess√°rio
                    if (favorites[channelData.id]) {
                        const favCard = channelCard.cloneNode(true);
                        favoritesChannelsContainer.appendChild(favCard);
                    }
                    
                    // Adiciona √† categoria apropriada
                    let categoryFound = false;
                    for (const [category, channelList] of Object.entries(channelCategories)) {
                        if (channelList.some(name => channelData.name.includes(name))) {
                            categoryFound = true;
                            switch (category) {
                                case 'movies':
                                    moviesChannels.appendChild(channelCard);
                                    channelCard.dataset.category = 'movies';
                                    break;
                                case 'documentary':
                                    documentaryChannels.appendChild(channelCard);
                                    channelCard.dataset.category = 'documentary';
                                    break;
                                case 'kids':
                                    kidsChannels.appendChild(channelCard);
                                    channelCard.dataset.category = 'kids';
                                    break;
                                case 'sports':
                                    sportsChannels.appendChild(channelCard);
                                    channelCard.dataset.category = 'sports';
                                    break;
                                default:
                                    otherChannels.appendChild(channelCard);
                                    channelCard.dataset.category = 'other';
                            }
                            break;
                        }
                    }
                    
                    if (!categoryFound) {
                        otherChannels.appendChild(channelCard);
                        channelCard.dataset.category = 'other';
                    }
                });
            }
            
            function updateProgrammesDisplay() {
                const channelCards = document.querySelectorAll('.channel-card');
                
                channelCards.forEach(card => {
                    const channelId = card.dataset.channelId;
                    const programmesList = card.querySelector('.programmes-list');
                    const channelProgrammes = allProgrammesByChannel[channelId] || [];
                    const currentProgrammes = getExactlyFiveProgrammes(channelProgrammes).slice(0, 2);
                    
                    programmesList.innerHTML = '';
                    
                    if (currentProgrammes.length === 0) {
                        programmesList.innerHTML = '<p class="text-gray-400 italic text-sm">Nenhuma programa√ß√£o dispon√≠vel</p>';
                    } else {
                        currentProgrammes.forEach((programme, index) => {
                            programmesList.appendChild(createProgrammeItem(programme, index === 0));
                        });
                    }
                });
                
                const now = new Date();
                lastUpdateDisplay.textContent = now.toLocaleTimeString('pt-BR', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }
            
            function checkEmptySections() {
                const sections = [
                    { id: 'favorites-section', container: favoritesChannelsContainer },
                    { id: 'movies-section', container: moviesChannels },
                    { id: 'documentary-section', container: documentaryChannels },
                    { id: 'kids-section', container: kidsChannels },
                    { id: 'sports-section', container: sportsChannels },
                    { id: 'other-section', container: otherChannels }
                ];
                
                sections.forEach(section => {
                    const visibleChannels = section.container.querySelectorAll('.channel-card:not(.hidden)');
                    const sectionElement = document.getElementById(section.id);
                    
                    if (visibleChannels.length === 0) {
                        sectionElement.classList.add('hidden');
                    } else {
                        sectionElement.classList.remove('hidden');
                    }
                });
            }
            
            function parseEPGDate(dateString) {
                const year = parseInt(dateString.substring(0, 4));
                const month = parseInt(dateString.substring(4, 6)) - 1;
                const day = parseInt(dateString.substring(6, 8));
                const hour = parseInt(dateString.substring(8, 10));
                const minute = parseInt(dateString.substring(10, 12));
                const second = parseInt(dateString.substring(12, 14));
                
                return new Date(year, month, day, hour, minute, second);
            }
            
            function formatDateTime(date) {
                const weekday = weekdaysShort[date.getDay()];
                return `${date.toLocaleTimeString('pt-BR', {
                    hour: '2-digit',
                    minute: '2-digit'
                })} | ${weekday}`;
            }
            
            function formatFullDateTime(date) {
                const weekday = weekdaysShort[date.getDay()];
                return `${date.toLocaleDateString('pt-BR', {
                    day: '2-digit',
                    month: '2-digit'
                })} ${date.toLocaleTimeString('pt-BR', {
                    hour: '2-digit',
                    minute: '2-digit'
                })} | ${weekday}`;
            }
            
            function getChannelLogo(channelName) {
                for (const [key, url] of Object.entries(channelLogos)) {
                    if (channelName.includes(key)) {
                        return url;
                    }
                }
                
                return `https://via.placeholder.com/50x30/1a1a2e/ffffff?text=${encodeURIComponent(channelName.substring(0, 3))}`;
            }
            
            function getRatingImage(rating) {
                if (!rating) return null;
                
                rating = rating.toUpperCase();
                
                if (rating.includes('LIVRE') || rating === 'L') return ratingImages['L'];
                if (rating.includes('10') || rating.includes('DEZ')) return ratingImages['10'];
                if (rating.includes('12') || rating.includes('DOZE')) return ratingImages['12'];
                if (rating.includes('14') || rating.includes('QUATORZE')) return ratingImages['14'];
                if (rating.includes('16') || rating.includes('DEZESSEIS')) return ratingImages['16'];
                if (rating.includes('18') || rating.includes('DEZOITO')) return ratingImages['18'];
                
                return null;
            }
            
            function getExactlyFiveProgrammes(programmes) {
                const now = new Date();
                const sortedProgrammes = [...programmes].sort((a, b) => {
                    const startTimeA = parseEPGDate(a.getAttribute('start'));
                    const startTimeB = parseEPGDate(b.getAttribute('start'));
                    return startTimeA - startTimeB;
                });
                
                let currentIndex = -1;
                
                for (let i = 0; i < sortedProgrammes.length; i++) {
                    const startTime = parseEPGDate(sortedProgrammes[i].getAttribute('start'));
                    const endTime = parseEPGDate(sortedProgrammes[i].getAttribute('stop'));
                    
                    if (startTime <= now && endTime > now) {
                        currentIndex = i;
                        break;
                    }
                }
                
                if (currentIndex === -1) {
                    for (let i = 0; i < sortedProgrammes.length; i++) {
                        const startTime = parseEPGDate(sortedProgrammes[i].getAttribute('start'));
                        if (startTime > now) {
                            currentIndex = i;
                            break;
                        }
                    }
                }
                
                if (currentIndex === -1) return [];
                return sortedProgrammes.slice(currentIndex, currentIndex + 5);
            }
            
            function createAndAppendChannelCard(channelName, channelId) {
                if (document.querySelector(`.channel-card[data-channel-id="${channelId}"]`)) {
                    return;
                }
                
                const channelProgrammes = allProgrammesByChannel[channelId] || [];
                const exactlyTwoProgrammes = getExactlyFiveProgrammes(channelProgrammes).slice(0, 2);
                const channelCard = createChannelCard(channelName, exactlyTwoProgrammes, channelId);
                
                return channelCard;
            }
            
            function createChannelCard(channelName, programmes, channelId) {
                const card = document.createElement('div');
                card.className = 'channel-card';
                card.dataset.channelId = channelId;
                
                // Verifica se √© favorito
                const favorites = JSON.parse(localStorage.getItem('favoriteChannels')) || {};
                const isFavorite = favorites[channelId];
                if (isFavorite) {
                    card.classList.add('favorite');
                }
                
                // Cabe√ßalho
                const header = document.createElement('div');
                header.className = 'bg-gray-800 p-3 flex items-center min-h-[60px]';
                
                const logoElement = document.createElement('img');
                logoElement.className = 'h-8 w-8 min-w-[32px] mr-2 object-contain';
                logoElement.src = getChannelLogo(channelName);
                logoElement.alt = `${channelName} Logo`;
                logoElement.onerror = function() {
                    this.onerror = null;
                    this.src = `https://via.placeholder.com/50x30/1a1a2e/ffffff?text=${encodeURIComponent(channelName.substring(0, 3))}`;
                };
                
                const nameElement = document.createElement('h3');
                nameElement.className = 'channel-name text-sm font-semibold text-white';
                nameElement.textContent = channelName.length > 20 ? 
                    channelName.substring(0, 20) + '...' : channelName;
                nameElement.title = channelName;
                
                // Adiciona estrela de favoritos
                const starIcon = document.createElement('button');
                starIcon.className = `favorite-star ml-auto ${isFavorite ? 'text-yellow-400' : 'text-gray-400'}`;
                starIcon.innerHTML = '‚òÖ';
                starIcon.dataset.channel = channelId;
                starIcon.ariaLabel = isFavorite ? 'Remover dos favoritos' : 'Adicionar aos favoritos';
                starIcon.onclick = (e) => {
                    e.stopPropagation();
                    toggleFavorite(channelId, channelName);
                };
                
                header.appendChild(logoElement);
                header.appendChild(nameElement);
                header.appendChild(starIcon);
                card.appendChild(header);
                
                // Lista de programas
                const programmesList = document.createElement('div');
                programmesList.className = 'programmes-list p-3 space-y-2 flex-grow';
                
                if (programmes.length === 0) {
                    programmesList.innerHTML = '<p class="text-gray-400 italic text-sm">Sem programa√ß√£o</p>';
                } else {
                    programmes.forEach((programme, index) => {
                        programmesList.appendChild(createProgrammeItem(programme, index === 0));
                    });
                }
                
                card.appendChild(programmesList);
                
                // Bot√£o
                const button = document.createElement('button');
                button.className = 'mt-auto mx-3 mb-3 py-1.5 text-sm bg-gray-800 hover:bg-gray-700 text-white rounded';
                button.textContent = 'Programa√ß√£o completa';
                button.onclick = () => showFullSchedule(channelName, channelId, logoElement.src);
                
                card.appendChild(button);
                
                return card;
            }
            
            function toggleFavorite(channelId, channelName) {
                const favorites = JSON.parse(localStorage.getItem('favoriteChannels')) || {};
                favorites[channelId] = !favorites[channelId];
                localStorage.setItem('favoriteChannels', JSON.stringify(favorites));
                
                // Atualiza UI
                const starIcon = document.querySelector(`.favorite-star[data-channel="${channelId}"]`);
                if (starIcon) {
                    starIcon.classList.toggle('text-yellow-400', favorites[channelId]);
                    starIcon.classList.toggle('text-gray-400', !favorites[channelId]);
                    starIcon.ariaLabel = favorites[channelId] ? 'Remover dos favoritos' : 'Adicionar aos favoritos';
                }
                
                // Atualiza card
                const card = document.querySelector(`.channel-card[data-channel-id="${channelId}"]`);
                if (card) {
                    card.classList.toggle('favorite', favorites[channelId]);
                }
                
                // Atualiza lista de favoritos
                displayChannels();
            }
            
            function createProgrammeItem(programme, isCurrent = false) {
                const startTime = parseEPGDate(programme.getAttribute('start'));
                const endTime = parseEPGDate(programme.getAttribute('stop'));
                const title = programme.getElementsByTagName('title')[0]?.textContent || 'Programa sem t√≠tulo';
                const description = programme.getElementsByTagName('desc')[0]?.textContent || '';
                
                let ratingValue = null;
                const ratingElements = programme.getElementsByTagName('rating');
                if (ratingElements.length > 0) {
                    const valueElement = ratingElements[0].getElementsByTagName('value')[0];
                    if (valueElement) ratingValue = valueElement.textContent;
                }
                
                const programmeItem = document.createElement('div');
                programmeItem.className = 'programme-item';
                
                const now = new Date();
                if (isCurrent && startTime <= now && endTime > now) {
                    programmeItem.classList.add('bg-gray-800', 'bg-opacity-30');
                }
                
                const timeElement = document.createElement('div');
                timeElement.className = 'programme-time text-xs text-orange-400 flex items-center';
                
                const timeText = document.createElement('span');
                timeText.textContent = `${formatDateTime(startTime)} - ${formatDateTime(endTime)}`;
                timeElement.appendChild(timeText);
                
                if (startTime <= now && endTime > now) {
                    const liveIndicator = document.createElement('span');
                    liveIndicator.className = 'live-indicator';
                    liveIndicator.textContent = 'AO VIVO';
                    timeElement.appendChild(liveIndicator);
                }
                
                const titleElement = document.createElement('div');
                titleElement.className = 'programme-title font-medium text-sm mt-1';
                titleElement.textContent = title.length > 30 ? 
                    title.substring(0, 30) + '...' : title;
                titleElement.title = title;
                
                const ratingImageUrl = getRatingImage(ratingValue);
                if (ratingImageUrl) {
                    const ratingImg = document.createElement('img');
                    ratingImg.className = 'rating-icon ml-2';
                    ratingImg.src = ratingImageUrl;
                    ratingImg.alt = `Classifica√ß√£o ${ratingValue}`;
                    titleElement.appendChild(ratingImg);
                }
                
                programmeItem.appendChild(timeElement);
                programmeItem.appendChild(titleElement);
                
                if (description) {
                    const descElement = document.createElement('div');
                    descElement.className = 'programme-desc text-xs text-gray-400 mt-1';
                    descElement.textContent = description.length > 60 ? 
                        description.substring(0, 60) + '...' : description;
                    descElement.title = description;
                    programmeItem.appendChild(descElement);
                }
                
                return programmeItem;
            }
            
            function showFullSchedule(channelName, channelId, logoUrl) {
                modalChannelName.textContent = channelName;
                modalChannelLogo.src = logoUrl;
                modalChannelLogo.alt = `${channelName} Logo`;
                modalScheduleList.innerHTML = '';
                
                const channelProgrammes = allProgrammesByChannel[channelId] || [];
                const now = new Date();
                
                const futureProgrammes = channelProgrammes
                    .filter(programme => {
                        const endTime = parseEPGDate(programme.getAttribute('stop'));
                        return endTime > now;
                    })
                    .sort((a, b) => {
                        const startTimeA = parseEPGDate(a.getAttribute('start'));
                        const startTimeB = parseEPGDate(b.getAttribute('start'));
                        return startTimeA - startTimeB;
                    });
                
                if (futureProgrammes.length === 0) {
                    modalScheduleList.innerHTML = '<p class="text-gray-400 italic text-center py-4">Nenhuma programa√ß√£o dispon√≠vel para as pr√≥ximas 24 horas</p>';
                } else {
                    const firstProgrammeDate = parseEPGDate(futureProgrammes[0].getAttribute('start'));
                    const dateHeader = document.createElement('div');
                    dateHeader.className = 'text-vibrant-orange font-bold text-lg mb-2 border-b border-gray-700 pb-1';
                    dateHeader.textContent = firstProgrammeDate.toLocaleDateString('pt-BR', { 
                        weekday: 'long', 
                        day: '2-digit', 
                        month: '2-digit', 
                        year: 'numeric' 
                    });
                    modalScheduleList.appendChild(dateHeader);
                    
                    futureProgrammes.forEach(programme => {
                        const startTime = parseEPGDate(programme.getAttribute('start'));
                        const endTime = parseEPGDate(programme.getAttribute('stop'));
                        const title = programme.getElementsByTagName('title')[0]?.textContent || 'Programa sem t√≠tulo';
                        const description = programme.getElementsByTagName('desc')[0]?.textContent || '';
                        
                        let ratingValue = null;
                        const ratingElements = programme.getElementsByTagName('rating');
                        if (ratingElements.length > 0) {
                            const valueElement = ratingElements[0].getElementsByTagName('value')[0];
                            if (valueElement) ratingValue = valueElement.textContent;
                        }
                        
                        const programmeItem = document.createElement('div');
                        programmeItem.className = 'bg-gray-800 bg-opacity-30 rounded-md p-3 mb-2';
                        
                        const now = new Date();
                        if (startTime <= now && endTime > now) {
                            programmeItem.classList.add('border', 'border-vibrant-orange');
                        }
                        
                        const timeElement = document.createElement('div');
                        timeElement.className = 'flex items-center text-sm font-medium text-vibrant-orange mb-1';
                        
                        const startWeekday = weekdaysShort[startTime.getDay()];
                        const endWeekday = weekdaysShort[endTime.getDay()];
                        
                        timeElement.innerHTML = `${startTime.toLocaleTimeString('pt-BR', {
                            hour: '2-digit',
                            minute: '2-digit'
                        })} | ${startWeekday} - ${endTime.toLocaleTimeString('pt-BR', {
                            hour: '2-digit',
                            minute: '2-digit'
                        })} | ${endWeekday}`;
                        
                        if (startTime <= now && endTime > now) {
                            const liveIndicator = document.createElement('span');
                            liveIndicator.className = 'live-indicator';
                            liveIndicator.textContent = 'AO VIVO';
                            timeElement.appendChild(liveIndicator);
                        }
                        
                        const titleElement = document.createElement('div');
                        titleElement.className = 'font-medium';
                        titleElement.textContent = title;
                        
                        const ratingImageUrl = getRatingImage(ratingValue);
                        if (ratingImageUrl) {
                            const ratingImg = document.createElement('img');
                            ratingImg.className = 'rating-icon ml-2';
                            ratingImg.src = ratingImageUrl;
                            ratingImg.alt = `Classifica√ß√£o ${ratingValue}`;
                            titleElement.appendChild(ratingImg);
                        }
                        
                        programmeItem.appendChild(timeElement);
                        programmeItem.appendChild(titleElement);
                        
                        if (description) {
                            const descElement = document.createElement('div');
                            descElement.className = 'text-sm text-gray-300 mt-1';
                            descElement.textContent = description;
                            programmeItem.appendChild(descElement);
                        }
                        
                        modalScheduleList.appendChild(programmeItem);
                    });
                }
                
                modal.style.display = 'block';
            }
            
            async function carregarFilmes() {
                const container = document.getElementById("filmes");
                container.innerHTML = '<div class="loading-spinner mx-auto"></div>';
                
                const canais = [
                    "Telecine Action", "Telecine Premium", "Telecine Pipoca", "Megapix", "HBO Family", "HBO", "HBO2",
                    "Cinemax", "Telecine Touch", "Paramount", "Telecine Fun"
                ];
                
                try {
                    const response = await fetch(epgSources[0]);
                    const xmlText = await response.text();
                    const parser = new DOMParser();
                    const xml = parser.parseFromString(xmlText, "text/xml");
                    
                    const programas = Array.from(xml.getElementsByTagName("programme"));
                    const hoje = new Date();
                    const hojeStr = hoje.toISOString().split("T")[0].replace(/-/g, "");
                    
                    const titulosUnicos = new Set();
                    container.innerHTML = "";
                    
                    for (const canal of canais) {
                        const programasDoCanal = programas.filter(p => {
                            const channel = p.getAttribute("channel") || "";
                            const start = p.getAttribute("start") || "";
                            
                            const startTime = new Date(
                                parseInt(start.slice(0, 4)),
                                parseInt(start.slice(4, 6)) - 1,
                                parseInt(start.slice(6, 8)),
                                parseInt(start.slice(8, 10)),
                                parseInt(start.slice(10, 12))
                            );
                            
                            return channel.toLowerCase().includes(canal.toLowerCase()) &&
                                   start.startsWith(hojeStr) &&
                                   startTime >= new Date();
                        });
                        
                        for (const filme of programasDoCanal) {
                            const titleRaw = filme.getElementsByTagName("title")[0]?.textContent || "Sem t√≠tulo";
                            const titleClean = titleRaw.normalize("NFD").replace(/[ÃÄ-ÕØ]/g, "").toLowerCase();
                            
                            if (titulosUnicos.has(titleClean)) continue;
                            
                            const img = await buscarImagemFilme(titleRaw);
                            if (img.includes("via.placeholder.com")) continue;
                            
                            titulosUnicos.add(titleClean);
                            
                            const channel = filme.getAttribute("channel");
                            const start = filme.getAttribute("start");
                            const horario = start ? start.slice(8, 10) + ":" + start.slice(10, 12) : "--:--";
                            const rating = filme.getElementsByTagName("rating")[0]?.textContent || "L";
                            
                            const card = document.createElement("div");
                            card.className = "movie-card";
                            card.innerHTML = `
                                <img src="${img}" alt="${titleRaw}" class="w-full h-60 object-cover mb-2 rounded" loading="lazy">
                                <h3 class="text-sm font-bold text-white">${titleRaw}</h3>
                                <p class="text-xs text-gray-300">Canal: ${channel}</p>
                                <p class="text-xs text-gray-300">Hor√°rio: ${horario}</p>
                                <p class="text-xs text-yellow-400">Classifica√ß√£o: ${rating}</p>
                            `;
                            container.appendChild(card);
                            
                            break;
                        }
                    }
                } catch (error) {
                    console.error("Erro ao carregar filmes:", error);
                    container.innerHTML = '<p class="text-red-400 text-center py-4">Erro ao carregar filmes</p>';
                }
            }
            
            async function buscarImagemFilme(tituloOriginal) {
                const variacoes = [
                    tituloOriginal,
                    tituloOriginal.normalize("NFD").replace(/[\u0300-\u036f]/g, ""),
                    tituloOriginal.split(":")[0],
                    tituloOriginal.split("-")[0],
                    tituloOriginal.replace(/\s+\d{4}$/, "")
                ];
                
                for (const titulo of variacoes) {
                    try {
                        const resposta = await fetch(`https://api.themoviedb.org/3/search/movie?api_key=${tmdbApiKey}&query=${encodeURIComponent(titulo.trim())}`);
                        const dados = await resposta.json();
                        
                        const filme = dados.results?.find(f => f.poster_path || f.backdrop_path);
                        
                        if (filme) {
                            if (filme.poster_path) {
                                return `https://image.tmdb.org/t/p/w500${filme.poster_path}`;
                            } else if (filme.backdrop_path) {
                                return `https://image.tmdb.org/t/p/w500${filme.backdrop_path}`;
                            }
                        }
                    } catch (erro) {
                        console.error("Erro ao buscar imagem:", titulo, erro);
                    }
                }
                
                return `https://via.placeholder.com/300x450?text=${encodeURIComponent(tituloOriginal)}`;
            }
            
            // Fun√ß√µes auxiliares para eventos esportivos
            function formatarDataHoraCompleta(date) {
                const diasSemana = ['dom', 'seg', 'ter', 'qua', 'qui', 'sex', 'sab'];
                const dia = date.getDate().toString().padStart(2, '0');
                const mes = (date.getMonth() + 1).toString().padStart(2, '0');
                const hora = date.getHours().toString().padStart(2, '0');
                const diaSemana = diasSemana[date.getDay()];
                
                return `${dia}/${mes} ${hora}h (${diaSemana})`;
            }
            
            function getStatusEvento(dataEvento, agora) {
                const inicio = new Date(dataEvento);
                const fim = new Date(inicio);
                fim.setHours(fim.getHours() + 2); // Assumindo dura√ß√£o de 2 horas
                
                if (inicio <= agora && fim > agora) return 'live';
                if (inicio > agora && (inicio - agora) <= (5 * 60 * 60 * 1000)) return 'soon';
                return 'upcoming';
            }
            
            function corrigirNomeTime(nome) {
                const correcoes = {
                    "VT-": "",
                    "brasil": "Brasil",
                    "vitorias": "Vit√≥ria",
                    "fla": "Flamengo",
                    "flu": "Fluminense",
                    "bot": "Botafogo",
                    "cor": "Corinthians",
                    "pal": "Palmeiras",
                    "spfc": "S√£o Paulo",
                    "san": "Santos",
                    "campeonato": "",
                    "brasileiro": "",
                    "libertadores": ""
                };
                
                let nomeCorrigido = nome;
                for (const [erro, correcao] of Object.entries(correcoes)) {
                    nomeCorrigido = nomeCorrigido.replace(new RegExp(erro, 'gi'), correcao);
                }
                
                // Capitalizar primeira letra
                nomeCorrigido = nomeCorrigido.trim();
                if (nomeCorrigido.length > 0) {
                    nomeCorrigido = nomeCorrigido.charAt(0).toUpperCase() + nomeCorrigido.slice(1).toLowerCase();
                }
                
                return nomeCorrigido || "Time desconhecido";
            }
            
            function normalizarEsporte(titulo, desc) {
                const texto = (titulo + desc).toLowerCase();
                
                if (/(futebol|brasileiro|brasileir√£o|paulista|carioca|libertadores|laliga|champions)/i.test(texto)) {
                    return "Futebol";
                }
                if (/(ufc|mma|luta|mixed martial arts)/i.test(texto)) {
                    return "UFC";
                }
                if (/box/i.test(texto)) {
                    return "Boxe";
                }
                if (/(volei|v√¥lei)/i.test(texto)) {
                    return "V√¥lei";
                }
                if (/(nba|basquete)/i.test(texto)) {
                    return "Basquete";
                }
                return "Outros Esportes";
            }
            
            function extrairTimes(titulo) {
                // Primeiro tenta encontrar padr√£o com "x" ou "vs"
                const regexPadrao = /(.+?)\s+(?:vs|x|√ó)\s+(.+)/i;
                const matchPadrao = titulo.match(regexPadrao);
                if (matchPadrao) {
                    return [corrigirNomeTime(matchPadrao[1]), corrigirNomeTime(matchPadrao[2])];
                }
                
                // Se n√£o encontrar, tenta dividir por h√≠fen
                const partes = titulo.split(/[-‚Äì]/);
                if (partes.length >= 2) {
                    return [corrigirNomeTime(partes[0]), corrigirNomeTime(partes[1])];
                }
                
                // Se n√£o conseguir, retorna o t√≠tulo original
                return [corrigirNomeTime(titulo), ""];
            }
            
            function getLogoCanalEsportivo(canalNome) {
                for (const [canal, logo] of Object.entries(logosCanaisEsportivos)) {
                    if (canalNome.includes(canal)) return logo;
                }
                return null;
            }
            
            function criarCardEvento(evento) {
                // Fun√ß√£o auxiliar para encontrar o escudo mais adequado
                const encontrarEscudo = (nomeTime) => {
                    // Primeiro verifica se temos um escudo exato
                    if (escudos[nomeTime]) return escudos[nomeTime];
                    
                    // Se n√£o, procura por correspond√™ncia parcial
                    for (const [time, escudo] of Object.entries(escudos)) {
                        if (nomeTime.toLowerCase().includes(time.toLowerCase())) {
                            return escudo;
                        }
                    }
                    
                    // Se n√£o encontrar, usa um placeholder
                    return `https://via.placeholder.com/80?text=${encodeURIComponent(nomeTime.substring(0, 2))}`;
                };

                const escudo1 = encontrarEscudo(evento.time1);
                const escudo2 = encontrarEscudo(evento.time2);
                const dataHora = formatarDataHoraCompleta(evento.data);
                const logoCanal = getLogoCanalEsportivo(evento.canal);
                
                const card = document.createElement("div");
                card.className = "sport-event-card";
                
                // Adiciona classes baseadas no status
                if (evento.status === 'live') {
                    card.classList.add("live");
                } else if (evento.status === 'soon') {
                    card.classList.add("soon");
                }
                
                card.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-bold text-orange-500">${evento.esporte}</span>
                        <span class="text-xs text-gray-400">${dataHora}</span>
                    </div>
                    
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex flex-col items-center w-1/3">
                            <img src="${escudo1}" alt="${evento.time1}" class="h-10 w-10 object-contain mb-1" loading="lazy" onerror="this.onerror=null;this.src='https://via.placeholder.com/80?text=${encodeURIComponent(evento.time1.substring(0, 2))}'">
                            <span class="text-sm text-center text-white">${evento.time1.length > 12 ? evento.time1.substring(0, 10) + '...' : evento.time1}</span>
                        </div>
                        <div class="text-xl font-bold text-white mx-2">X</div>
                        <div class="flex flex-col items-center w-1/3">
                            <img src="${escudo2}" alt="${evento.time2}" class="h-10 w-10 object-contain mb-1" loading="lazy" onerror="this.onerror=null;this.src='https://via.placeholder.com/80?text=${encodeURIComponent(evento.time2.substring(0, 2))}'">
                            <span class="text-sm text-center text-white">${evento.time2.length > 12 ? evento.time2.substring(0, 10) + '...' : evento.time2}</span>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-center gap-2">
                        ${logoCanal ? `<img src="${logoCanal}" alt="${evento.canal}" class="h-4" loading="lazy">` : ''}
                        <span class="text-xs text-gray-300">${evento.canal}</span>
                        ${evento.status === 'live' ? '<span class="live-indicator ml-2">AO VIVO</span>' : ''}
                        ${evento.status === 'soon' ? '<span class="soon-indicator ml-2">EM BREVE</span>' : ''}
                    </div>
                `;
                
                return card;
            }
            
            function criarCardEventoMMA(evento) {
                // Fun√ß√£o para encontrar a imagem do lutador
                const encontrarImagemLutador = (nomeLutador) => {
                    // Procura pelo lutador (com toler√¢ncia a varia√ß√µes no nome)
                    for (const [nome, img] of Object.entries(lutadoresUFC)) {
                        if (nomeLutador.toLowerCase().includes(nome.toLowerCase())) {
                            return img;
                        }
                    }
                    
                    // Se n√£o encontrar, usa um placeholder gen√©rico
                    return `https://via.placeholder.com/150?text=${encodeURIComponent(nomeLutador.substring(0, 1))}`;
                };

                const imagemLutador1 = encontrarImagemLutador(evento.time1);
                const imagemLutador2 = encontrarImagemLutador(evento.time2);
                const dataHora = formatarDataHoraCompleta(evento.data);
                const logoCanal = getLogoCanalEsportivo(evento.canal);
                
                const card = document.createElement("div");
                card.className = "sport-event-card mma";
                
                // Adiciona classes baseadas no status
                if (evento.status === 'live') {
                    card.classList.add("live");
                } else if (evento.status === 'soon') {
                    card.classList.add("soon");
                }
                
                card.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-bold text-orange-500">${evento.esporte}</span>
                        <span class="text-xs text-gray-400">${dataHora}</span>
                    </div>
                    
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex flex-col items-center w-1/3">
                            <img src="${imagemLutador1}" alt="${evento.time1}" class="fighter-image" loading="lazy" onerror="this.onerror=null;this.src='https://via.placeholder.com/150?text=${encodeURIComponent(evento.time1.substring(0, 1))}'">
                            <span class="fighter-name">${evento.time1.length > 12 ? evento.time1.substring(0, 10) + '...' : evento.time1}</span>
                            <span class="fighter-nickname">${evento.time1.includes(' ') ? evento.time1.split(' ')[1] : ''}</span>
                        </div>
                        <div class="text-xl font-bold text-white mx-2">VS</div>
                        <div class="flex flex-col items-center w-1/3">
                            <img src="${imagemLutador2}" alt="${evento.time2}" class="fighter-image" loading="lazy" onerror="this.onerror=null;this.src='https://via.placeholder.com/150?text=${encodeURIComponent(evento.time2.substring(0, 1))}'">
                            <span class="fighter-name">${evento.time2.length > 12 ? evento.time2.substring(0, 10) + '...' : evento.time2}</span>
                            <span class="fighter-nickname">${evento.time2.includes(' ') ? evento.time2.split(' ')[1] : ''}</span>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-center gap-2">
                        ${logoCanal ? `<img src="${logoCanal}" alt="${evento.canal}" class="h-4" loading="lazy">` : ''}
                        <span class="text-xs text-gray-300">${evento.canal}</span>
                        ${evento.status === 'live' ? '<span class="live-indicator ml-2">AO VIVO</span>' : ''}
                        ${evento.status === 'soon' ? '<span class="soon-indicator ml-2">EM BREVE</span>' : ''}
                    </div>
                `;
                
                return card;
            }
            
            async function carregarEventosEsportivos() {
                const container = document.getElementById("jogos-container");
                container.innerHTML = '<div class="loading-spinner mx-auto"></div>';
                
                try {
                    const eventosMap = new Map();
                    const now = new Date();
                    
                    for (const url of epgSources) {
                        try {
                            const res = await fetch(url);
                            const xmlText = await res.text();
                            const xml = new DOMParser().parseFromString(xmlText, "text/xml");
                            
                            Array.from(xml.getElementsByTagName("programme")).forEach(prog => {
                                const titulo = prog.getElementsByTagName("title")[0]?.textContent || "";
                                const desc = prog.getElementsByTagName("desc")[0]?.textContent || "";
                                const canal = prog.getAttribute("channel") || "";
                                
                                // Verifica se √© um canal esportivo
                                const isCanalEsportivo = canaisEsportivos.some(c => canal.includes(c));
                                if (!isCanalEsportivo) return;
                                
                                // Verifica se parece ser um evento esportivo (cont√©m times ou palavras-chave)
                                const isEventoEsportivo = /(vs|x|√ó|jogo|partida|campeonato|liga|luta|ufc|mma)/i.test(titulo + desc);
                                if (!isEventoEsportivo) return;
                                
                                const inicio = prog.getAttribute("start");
                                const data = new Date(
                                    parseInt(inicio.slice(0, 4)),
                                    parseInt(inicio.slice(4, 6)) - 1,
                                    parseInt(inicio.slice(6, 8)),
                                    parseInt(inicio.slice(8, 10)),
                                    parseInt(inicio.slice(10, 12))
                                );
                                
                                // Ajustar para o dia selecionado
                                const hoje = new Date();
                                hoje.setDate(hoje.getDate() + currentDayOffset);
                                hoje.setHours(0, 0, 0, 0);
                                
                                const amanha = new Date(hoje);
                                amanha.setDate(amanha.getDate() + 1);
                                
                                if (data < hoje || data >= amanha) return;
                                
                                // Determina o esporte
                                const esporte = normalizarEsporte(titulo, desc);
                                
                                // Filtra por esporte selecionado
                                if (currentSportFilter !== "Futebol" && esporte !== currentSportFilter) return;
                                
                                // Extrai os participantes
                                let [time1, time2] = extrairTimes(titulo);
                                
                                // Para UFC/MMA, ajusta os nomes
                                if (esporte === "UFC") {
                                    // Tenta extrair os nomes dos lutadores
                                    const lutadores = titulo.match(/(.+?)\s+(?:vs|x|√ó)\s+(.+)/i) || 
                                                     titulo.match(/(.+?)\s+(?:vs|x|√ó)\s+(.+)/i) || 
                                                     [null, time1, time2];
                                    time1 = lutadores[1] || time1;
                                    time2 = lutadores[2] || time2;
                                }
                                
                                if (!time1 || !time2) return;
                                
                                // Determina o status do evento
                                const status = getStatusEvento(data, now);
                                
                                // Cria o objeto do evento
                                const evento = {
                                    titulo, 
                                    data, 
                                    time1, 
                                    time2, 
                                    esporte,
                                    canal,
                                    status
                                };
                                
                                // Adiciona ao mapa (evita duplicatas)
                                eventosMap.set(`${time1}-${time2}-${data.getTime()}`, evento);
                            });
                        } catch (error) {
                            console.error(`Erro ao processar eventos de ${url}:`, error);
                        }
                    }
                    
                    container.innerHTML = "";
                    const eventos = Array.from(eventosMap.values())
                        .sort((a, b) => a.data - b.data);
                    
                    if (eventos.length === 0) {
                        container.innerHTML = `<p class="text-gray-400 text-center py-4">Nenhum evento encontrado para ${currentSportFilter}</p>`;
                        return;
                    }
                    
                    // Agrupa por data
                    const eventosPorData = {};
                    eventos.forEach(evento => {
                        const dataKey = evento.data.toLocaleDateString('pt-BR');
                        if (!eventosPorData[dataKey]) {
                            eventosPorData[dataKey] = [];
                        }
                        eventosPorData[dataKey].push(evento);
                    });
                    
                    // Adiciona cabe√ßalho de data e os cards
                    for (const [dataStr, eventosDaData] of Object.entries(eventosPorData)) {
                        const dataHeader = document.createElement("div");
                        dataHeader.className = "text-vibrant-orange font-bold text-sm mb-2 mt-4 w-full";
                        dataHeader.textContent = `üìÖ ${dataStr}`;
                        container.appendChild(dataHeader);
                        
                        eventosDaData.forEach(evento => {
                            // Decide qual tipo de card usar baseado no esporte
                            if (evento.esporte === "UFC") {
                                container.appendChild(criarCardEventoMMA(evento));
                            } else {
                                container.appendChild(criarCardEvento(evento));
                            }
                        });
                    }
                } catch (error) {
                    console.error("Erro ao carregar eventos esportivos:", error);
                    container.innerHTML = `<p class="text-red-400 text-center py-4">Erro ao carregar eventos</p>`;
                }
            }
        });
    </script>
</body>
</html>